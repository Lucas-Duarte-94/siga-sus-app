syntax = "proto3";

// Gera classes Java separadas para cada message/service ao invés de uma única classe aninhada.
option java_multiple_files = true;

// Define o pacote Java para as classes geradas.
option java_package = "com.siga.sus.authorization.grpc";

// Define o nome da classe Java que será gerada para o serviço.
option java_outer_classname = "TokenValidationProto";

// Define o namespace/pacote do protobuf (diferente do pacote Java).
package tokenvalidation;

/**
  * service: Define um serviço gRPC
  * TokenValidationService: Nome do serviço
  * rpc ValidateToken: Define um método RPC chamado ValidateToke
  * ValidateTokenRequest: Mensagem de solicitação contendo o token a ser validado
  * ValidateTokenResponse: Mensagem de resposta contendo o resultado da validação
 */
service TokenValidationService {
  rpc ValidateToken(ValidateTokenRequest) returns (ValidateTokenResponse);
}

message ValidateTokenRequest {
  string token = 1;
}

message ValidateTokenResponse {
  bool valid = 1;
  string username = 2;
  string role = 3;
  string error_message = 4;
}